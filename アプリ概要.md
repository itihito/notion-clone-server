# Notion Clone アプリケーション

## デプロイ先

アプリは以下のサイトでデプロイしております。  
フロントエンド：vercel  
バックエンド：render

以下の URL からアクセス可能です。

https://notion-clone-client-six.vercel.app/#/login

\*15 分間アクセスがない場合、バックエンドサーバーがスリープモードに入ってしまい、起動に 1 分程度かかります。  
そのため、初回アクセス時などは動作が不安定な場合がございます。

## アプリ概要

Notion Clone アプリケーションは、メモ管理とユーザー認証機能を組み合わせた Notion ライクなメモアプリです。  
ユーザーはアカウント登録、及びユーザーのメモを作成し、編集・削除・お気に入り登録ができます。  
フロントエンドは React, Redux, Material UI を使用して構築し、
バックエンドでは Node.js と Express.js を使用し、データの永続化には MongoDB を採用しています。  
また、ユーザーの認証には JWT（JSON Web Token）を使用しています。

### フロントエンド

リポジトリ:https://github.com/itihito/notion-clone-client

フロントエンドは React.js を使用して構築されています。以下は主なファイルと機能の説明です。

- **API フェッチング**: `Axios を使用してバックエンドと通信するためのクライアントが構成しています。リクエストヘッダにトークンの認証情報を含め、リクエストとレスポンスのインターセプターを設定しています。

- **Redux による状態管理**: Redux のストアを設定し、`userReducer`と`memoReducer`を登録しています。これにより、ユーザー情報とメモ情報の状態が Redux ストアで管理されています。

- **ログイン状態の監視**: `AppLayout`、及び`AuthLayout` コンポーネントでは、`useEffect` フックを使用してページがロードされた時に `authUtils.isAuthenticated()` を呼び出し、ユーザーが認証済みかどうかを確認しています。認証状態に応じて適切なページにリダイレクトします。

- **リダイレクト処理**: `useNavigate` フックを使用して、認証済みでない場合は `/login` ページ、認証済みかつ存在しない URL の場合は`/`(トップページ)にリダイレクトしています。これにより、ユーザーがログインしていない状態で `/memo` や `/memo/:memoId` にアクセスしようとした場合、自動的にログインページに遷移します。

- **Markdown の表示**: メモのプレビュー画面では、`ReactMarkdown` および`remarkGfm`ライブラリを使用して Markdown をリアルタイムに再現しています。

  - 一部の記法は、ライブラリが対応しておらず再現できない記法もございます。

- **絵文字ピッカー**: `@emoji-mart/react` ライブラリを`EmojiPicker`コンポーネントで実装しており、Discord などでも使われる絵文字ピッカーを利用することができます。

- **Material UI の利用**: `各ページ要素、アイコンなどは Material UI を使って実装されています

### バックエンド

リポジトリ:https://github.com/itihito/notion-clone-server

バックエンドは Node.js および Express.js を使用して構築されています。以下は主な機能の説明です。

- **エントリーポイント**: ルートディレクリ直下の`index.js`が Express アプリケーションのエントリーポイントで、ミドルウェア、CORS の設定、ルーティングなどが含まれています。MongoDB との接続もこのファイルで行われます。

- **ミドルウェア**: リクエストのログを出力するミドルウェアが定義されています。リクエストのパス、メソッド、オリジンなどの出力を設定しています。

- **API ルーティング**: `src/v1/routes`以下のファイルでユーザーやメモに関する API のルーティングを設定しています。リクエストに応じてコントローラーから該当の処理を呼びだしています。

- **MongoDB のモデル定義**: `src/v1/models`以下のファイルで `mongoose`ライブラリを使用して MongoDB のモデル定義を提供しています。

- **JWT 認証**: ログイン時、レスポンスに JWT を付与しており、ログイン後の各リクエストで JWT 認証を実施してセキュアな処理を実現しています。

- **パスワードのハッシュ化**: ユーザーの登録パスワードは bcrypt を使用してハッシュ化しています。ハッシュ関数を用いることで、生のパスワードがデータベースに保存されず、セキュリティが向上します。ユーザーの新規登録時やログイン時にパスワードのハッシュ化と比較が行われ、安全な認証が実現されています。

### 技術

- **フロントエンド**: React.js, react-router, Axios, Redux, Material UI, emoji-mart, vite
- **バックエンド**: Node.js, Express.js, MongoDB
- **認証**: JWT, bcrypt
- **その他**: CORS, dotenv,
